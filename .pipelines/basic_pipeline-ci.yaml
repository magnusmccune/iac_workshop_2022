parameters:
  - name: location
    type: string
    default: 'canadacentral'
  - name: stgIndex
    type: string

steps:
  - task: AzureCLI@2
    inputs:
      azureSubscription: 'm3demos_prd'
      scriptType: 'batch'
      scriptLocation: 'inlineScript'
      inlineScript: |
        az deployment sub create \
          --location $(location) \
          --template-file $(Build.SourcesDirectory)/basic.bicep \
          --parameters $(Build.SourcesDirectory)/basic.parameters.json \
          --parameters stgindex=${{parameters.stgIndex}}